# LearnHub 配置示例
# 复制此文件为 config.yaml 并填入真实配置

# 服务器配置
server:
  # 服务监听地址和端口
  host: "0.0.0.0"
  port: 8080
  # 运行模式: debug | release
  mode: "debug"
  # 优雅关闭超时时间（秒）
  shutdown_timeout: 30

# 数据库配置
database:
  # MySQL 连接信息
  driver: "mysql"
  host: "localhost"
  port: 3306
  username: "learnhub_user"
  password: "YOUR_DB_PASSWORD_HERE"
  database: "learnhub"
  # 字符集
  charset: "utf8mb4"
  # 时区
  timezone: "Asia/Shanghai"
  # 连接池配置
  max_idle_conns: 10
  max_open_conns: 100
  conn_max_lifetime: 3600  # 秒

# Redis 配置（可选，用于缓存和队列）
redis:
  enabled: true
  host: "localhost"
  port: 6379
  password: ""
  db: 0
  # 连接池大小
  pool_size: 10

# JWT 认证配置
jwt:
  # 密钥（必须修改为随机字符串，建议使用 openssl rand -base64 32 生成）
  secret: "CHANGE_THIS_TO_RANDOM_SECRET_KEY"
  # Access Token 过期时间（分钟）
  access_token_expiry: 60
  # Refresh Token 过期时间（天）
  refresh_token_expiry: 7

# Meilisearch 配置（可选，用于全文检索）
meilisearch:
  enabled: true
  host: "http://localhost:7700"
  # API Key（生产环境必须配置）
  api_key: ""
  # 索引前缀
  index_prefix: "learnhub_"

# 文件存储配置
storage:
  # 存储类型: local | s3 | oss
  type: "local"
  # 本地存储路径
  local_path: "./data/attachments"
  # 文件大小限制（MB）
  max_file_size: 50
  # 允许的文件类型
  allowed_types:
    - "image/jpeg"
    - "image/png"
    - "image/gif"
    - "image/webp"
    - "application/pdf"
    - "application/msword"
    - "application/vnd.openxmlformats-officedocument.wordprocessingml.document"

# OCR 配置
ocr:
  # 默认引擎: local | cloud
  default_engine: "local"
  # 本地 PaddleOCR 服务地址
  local_endpoint: "http://localhost:8000"
  # 云 OCR 配置（可选）
  cloud:
    provider: ""  # 例如: "aliyun", "tencent", "baidu"
    app_id: ""
    api_key: ""
    secret_key: ""

# 监控配置
monitor:
  # 默认检测间隔（秒）
  default_interval: 300
  # 默认超时时间（毫秒）
  default_timeout: 5000
  # 探测结果保留天数
  probe_retention_days: 30

# 日志配置
logging:
  # 日志级别: debug | info | warn | error
  level: "info"
  # 日志格式: json | text
  format: "json"
  # 日志输出路径（留空则输出到标准输出）
  output: ""
  # 是否记录到文件
  file_enabled: false
  file_path: "./logs/app.log"
  # 日志轮转配置
  max_size: 100      # MB
  max_backups: 5
  max_age: 30        # 天
  compress: true

# CORS 配置
cors:
  # 允许的来源（生产环境请改为实际域名）
  allowed_origins:
    - "http://localhost:5173"
    - "http://localhost:3000"
  # 允许的方法
  allowed_methods:
    - "GET"
    - "POST"
    - "PUT"
    - "PATCH"
    - "DELETE"
    - "OPTIONS"
  # 允许的请求头
  allowed_headers:
    - "Authorization"
    - "Content-Type"
    - "X-Request-ID"
  # 是否允许携带凭证
  allow_credentials: true
  # 预检请求缓存时间（秒）
  max_age: 3600

# 限流配置
rate_limit:
  enabled: true
  # 全局限流：每 IP 每分钟请求数
  global_rps: 1000
  # 登录限流：每 IP 每小时尝试次数
  login_attempts: 10

# 备份配置（可选）
backup:
  enabled: false
  # 备份路径
  path: "./backups"
  # 备份间隔（小时）
  interval: 24
  # 保留份数
  retention: 7

# 通知配置（可选，用于监控告警）
notification:
  enabled: false
  # 通知方式: email | webhook | telegram
  channels:
    email:
      enabled: false
      smtp_host: "smtp.example.com"
      smtp_port: 587
      username: "noreply@example.com"
      password: "YOUR_EMAIL_PASSWORD"
      from: "LearnHub <noreply@example.com>"
    webhook:
      enabled: false
      url: "https://your-webhook-url.com"
    telegram:
      enabled: false
      bot_token: ""
      chat_id: ""

# 开发环境专用配置
dev:
  # 是否启用 SQL 日志
  sql_log: true
  # 是否启用 Profiling
  pprof: true
  # Profiling 监听端口
  pprof_port: 6060
